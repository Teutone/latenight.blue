function App(){var e=this;e.player={index:0,playlist:null,YTPlayer:null,YTVideo:null,updateCallback:null,episode:function(){return t.playlist[t.index].episode},convertTime:function(e){var t=Math.floor(e/60)+"",n=Math.floor(e-60*t)+"";return n.length<2&&(n="0"+n),t.length<2&&(t="0"+t),t+":"+n},vidLength:function(){return t.convertTime(t.YTPlayer.getDuration())},currentTime:function(){return t.convertTime(t.YTPlayer.getCurrentTime())},updateTime:function(){$("#timeIndex").innerHTML=t.currentTime()},playing:function(){return 1===t.YTPlayer.getPlayerState()||3===t.YTPlayer.getPlayerState()?!0:!1},init:function(){function n(e){t.YTVideo=e.target,t.YTPlayer.setVolume(100),t.togglePlay()}function o(){var e=t.currentSong();switch($("#title").innerHTML=e.title,$("#episode").innerHTML=e.episode,$("#artist").innerHTML=e.artist,$("#album").innerHTML=e.album,$("#length").innerHTML=t.vidLength(),$("#url").setAttribute("href",e.url),t.YTPlayer.getPlayerState()){case 3:break;case 0:t.next()}}function l(n){e.showError("An error occured. Skipping Track in 3 seconds..."),setTimeout(function(){t.next()},2800),console.log(n)}var r=t.getYTId(t.currentSong().url),i=document.createElement("div");i.id="player",$("#playerWrap").appendChild(i),e.player.YTPlayer=new YT.Player("player",{height:"390",width:"640",videoId:r,events:{onReady:n,onStateChange:o,onError:l}})},togglePlay:function(){t.playing()?(t.YTVideo.pauseVideo(),$("#playpausebutton").setAttribute("class","iconicstroke-play"),clearInterval(t.updateCallback)):(t.YTVideo.playVideo(),t.updateCallback=setInterval(function(){t.updateTime()},990),$("#playpausebutton").setAttribute("class","iconicstroke-pause"))},next:function(){t.index===t.playlist.length-1?t.index=0:t.index++,t.currentSong().deleted===!0?(e.showError("Episode not found. Skipping."),t.next()):(t.YTPlayer.pauseVideo(),t.YTPlayer.loadVideoById(t.getYTId(t.currentSong().url)),e.addHistory())},previous:function(){0===t.index?t.index=t.playlist.length-1:t.index--,t.currentSong().deleted===!0?(e.showError("Episode not found. Skipping."),t.previous()):(t.YTPlayer.pauseVideo(),t.YTPlayer.loadVideoById(t.getYTId(t.currentSong().url)),e.addHistory())},goTo:function(n){"number"==typeof n&&n>=0<t.playlist.length&&(t.index=n,t.currentSong().deleted===!0?(e.showError("Episode not found. Skipping."),t.next()):(t.YTPlayer.pauseVideo(),t.YTPlayer.loadVideoById(t.getYTId(t.currentSong().url)),e.addHistory()))},currentSong:function(){return t.playlist[t.index]},getYTId:function(e){var t=/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/,n=e.match(t);return n&&11==n[1].length?n[1]:!1},togglePlayerShow:function(){var t=$("#player");t.style.display="none"===e.getStyle(t,"display")?"block":"none"}};var t=e.player;e.updatePlaylist=function(n){e.getJSON("playlist",function(o,l){l?(console.log(l),e.showError("An error occurred updating the playlist.")):(t.playlist=o,n())})},e.showError=function(e){$("#error").style.display="block","string"==typeof e&&($("#error").innerHTML=e),setTimeout(function(){$("#error").style.display="none"},3e3)},e.showSuccess=function(e){$("#success").style.display="block","string"==typeof e&&($("#success").innerHTML=e),setTimeout(function(){$("#success").style.display="none"},3e3)},e.toggleFullscreen=function(){var e=$("#toggleFullscreen").children[0];document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),e.className="iconicstroke-fullscreen"):(document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),e.className="iconicstroke-fullscreen-exit")},e.addHistory=function(){history.pushState({index:t.index},"episode "+t.episode()+" of latenight.blue",""+t.episode()),$("#pagetitle").innerHTML="episode "+t.episode()+" of latenight.blue",ga("send",{hitType:"pageview",page:"/"+t.episode(),title:"episode "+t.episode()+" of latenight.blue"})},e.handlePopState=function(){var e=parseInt(window.location.pathname.substr(1));if(!isNaN(e)&&"number"==typeof e&&e>=0<t.playlist.length){for(var n=0;n<t.playlist.length;n++)if(t.playlist[n].episode===e){t.index=n;break}}else t.index=0;null!==t.YTPlayer&&t.goTo(t.index)},e.onKeyDown=function(e){32===e.keyCode?t.togglePlay():37===e.keyCode?t.previous():39===e.keyCode&&t.next()},e.init=function(){""!==$("#error").innerHTML&&e.showError(),e.updatePlaylist(function(){e.handlePopState(),e.player.init(),document.addEventListener("keydown",e.onKeyDown,!1);for(var n=$("a"),o=0;o<n.length;o++)n[o].onclick=function(n){if(n.target.hasAttribute("data-action"))var o=n.target.getAttribute("data-action");else var o=n.path[1].getAttribute("data-action");"function"==typeof t[o]?t[o]():"function"==typeof e[o]&&e[o]()}})},e.addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},e.removeClass=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},e.getStyle=function(e,t){if(e.currentStyle)var n=e.currentStyle[t];else if(window.getComputedStyle)var n=document.defaultView.getComputedStyle(e,null).getPropertyValue(t);else var n=void 0;return n},e.getJSON=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){if(this.status>=200&&this.status<400){var e=JSON.parse(this.response);t(e,!1)}else t(!1,"Server responded with an error.")},n.onerror=function(){t(!1,"An error occured fetching the playlist.")},n.send()}}function onYouTubeIframeAPIReady(){app=new App,window.onload=app.init()}function $(e){return document.querySelector?"#"===e.substring(0,1)?document.querySelector(e):document.querySelectorAll(e):"#"===e.substring(0,1)?document.getElementById(e.substr(1)):"."===e.substring(0,1)?document.getElementsByClassName(e.substr(1)):document.getElementsByTagName(e)}console.log("<3");var app;
