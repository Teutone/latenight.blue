function completely(e,t){function n(e){return void 0===y&&(y=document.createElement("span"),y.style.visibility="hidden",y.style.position="fixed",y.style.outline="0",y.style.margin="0",y.style.padding="0",y.style.border="0",y.style.left="0",y.style.whiteSpace="pre",y.style.fontSize=t.fontSize,y.style.fontFamily=t.fontFamily,y.style.fontWeight="normal",document.body.appendChild(y)),y.innerHTML=String(e).replace(/&/g,"&").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),y.getBoundingClientRect().right}t=t||{},t.fontSize=t.fontSize||"16px",t.fontFamily=t.fontFamily||"sans-serif",t.promptInnerHTML=t.promptInnerHTML||"",t.color=t.color||"#333",t.hintColor=t.hintColor||"#aaa",t.backgroundColor=t.backgroundColor||"#fff",t.dropDownBorderColor=t.dropDownBorderColor||"#aaa",t.dropDownZIndex=t.dropDownZIndex||"100",t.name=t.name||e.id,t.required=t.required||!0,t.placeholder=t.placeholder||"";var o=document.createElement("input");o.type="text",o.spellcheck=!1,o.style.fontSize=t.fontSize,o.style.fontFamily=t.fontFamily,o.style.color=t.color,o.style.backgroundColor=t.backgroundColor,o.style.width="100%",o.style.outline="0",o.style.margin="0",o.style.padding="0",o.setAttribute("name",t.name),t.required&&o.setAttribute("required",""),o.setAttribute("placeholder",t.placeholder);var l=o.cloneNode();l.disabled="",l.style.position="absolute",l.style.top="0",l.style.left="0",l.style.borderColor="transparent",l.style.boxShadow="none",l.style.color=t.hintColor,o.style.backgroundColor="transparent",o.style.verticalAlign="top",o.style.position="relative";var i=document.createElement("div");i.style.position="relative",i.style.outline="0",i.style.border="0",i.style.margin="0",i.style.padding="0";var r=document.createElement("div");if(r.style.position="absolute",r.style.outline="0",r.style.margin="0",r.style.padding="0",r.style.border="0",r.style.fontSize=t.fontSize,r.style.fontFamily=t.fontFamily,r.style.color=t.color,r.style.backgroundColor=t.backgroundColor,r.style.top="0",r.style.left="0",r.style.overflow="hidden",r.innerHTML=t.promptInnerHTML,r.style.background="transparent",void 0===document.body)throw"document.body is undefined. The library was wired up incorrectly.";document.body.appendChild(r);var a=r.getBoundingClientRect().right;i.appendChild(r),r.style.visibility="visible",r.style.left="-"+a+"px",i.style.marginLeft=a+"px",i.appendChild(l),i.appendChild(o);var s=document.createElement("div");s.style.position="absolute",s.style.visibility="hidden",s.style.outline="0",s.style.margin="0",s.style.padding="0",s.style.textAlign="left",s.style.fontSize=t.fontSize,s.style.fontFamily=t.fontFamily,s.style.backgroundColor=t.backgroundColor,s.style.zIndex=t.dropDownZIndex,s.style.cursor="default",s.style.borderStyle="solid",s.style.borderWidth="1px",s.style.borderColor=t.dropDownBorderColor,s.style.overflowX="hidden",s.style.whiteSpace="pre",s.style.overflowY="scroll";var d=function(e){var n=[],o=0,l=-1,i=function(){this.style.outline="1px solid #ddd"},r=function(){this.style.outline="0"},a=function(){s.hide(),s.onmouseselection(this.__hint)},s={hide:function(){e.style.visibility="hidden"},refresh:function(l,d){e.style.visibility="hidden",o=0,e.innerHTML="";var u=window.innerHeight||document.documentElement.clientHeight,y=e.parentNode.getBoundingClientRect(),c=y.top-6,p=u-y.bottom-6;n=[];for(var v=0;v<d.length;v++)if(0===d[v].indexOf(l)){var f=document.createElement("div");f.style.color=t.color,f.onmouseover=i,f.onmouseout=r,f.onmousedown=a,f.__hint=d[v],f.innerHTML=l+"<b>"+d[v].substring(l.length)+"</b>",n.push(f),e.appendChild(f)}0!==n.length&&(1!==n.length||l!==n[0].__hint)&&(n.length<2||(s.highlight(0),c>3*p?(e.style.maxHeight=c+"px",e.style.top="",e.style.bottom="100%"):(e.style.top="100%",e.style.bottom="",e.style.maxHeight=p+"px"),e.style.visibility="visible"))},highlight:function(e){-1!=l&&n[l]&&(n[l].style.backgroundColor=t.backgroundColor),n[e].style.backgroundColor=t.dropDownOnHoverBackgroundColor,l=e},move:function(t){return"hidden"===e.style.visibility?"":o+t===-1||o+t===n.length?n[o].__hint:(o+=t,s.highlight(o),n[o].__hint)},onmouseselection:function(){}};return s},u=d(s);u.onmouseselection=function(e){o.value=l.value=c+e,v.onChange(o.value),p=o.value,setTimeout(function(){o.focus()},0)},i.appendChild(s),e.appendChild(i);var y,c,p,v={onArrowDown:function(){},onArrowUp:function(){},onEnter:function(){},onTab:function(){},onChange:function(){v.repaint()},startFrom:0,options:[],wrapper:i,input:o,hint:l,dropDown:s,prompt:r,setText:function(e){l.value=e,o.value=e},getText:function(){return o.value},hideDropDown:function(){u.hide()},repaint:function(){var e=o.value,t=v.startFrom,i=v.options,r=i.length,a=e.substring(t);if(c=e.substring(0,t),l.value="",""!==a)for(var d=0;r>d;d++){var y=i[d];if(0===y.indexOf(a)){l.value=c+y;break}}s.style.left=n(c)+"px",u.refresh(a,v.options)}},f=function(e,t){p=e.value;var n=function(){var n=e.value;p!==n&&(p=n,t(n))};e.addEventListener?(e.addEventListener("input",n,!1),e.addEventListener("keyup",n,!1),e.addEventListener("change",n,!1)):(e.attachEvent("oninput",n),e.attachEvent("onkeyup",n),e.attachEvent("onchange",n))};f(o,function(e){v.onChange(e)});var h=function(e){e=e||window.event;var t=e.keyCode;if(33!=t&&34!=t){if(27==t)return u.hide(),l.value=o.value,void o.focus();if(39!=t&&35!=t&&9!=t)if(13!=t){if(40==t){var n=u.move(1);return""==n&&v.onArrowDown(),void(l.value=c+n)}if(38==t){var n=u.move(-1);return""==n&&v.onArrowUp(),l.value=c+n,e.preventDefault(),void e.stopPropagation()}l.value=""}else if(0==l.value.length)v.onEnter();else{var i="hidden"==s.style.visibility;if(u.hide(),i)return l.value=o.value,o.focus(),void v.onEnter();o.value=l.value;var r=p!=o.value;p=o.value,r&&v.onChange(o.value)}else if(9==t&&(e.preventDefault(),e.stopPropagation(),0==l.value.length&&v.onTab()),l.value.length>0){u.hide(),o.value=l.value;var r=p!=o.value;p=o.value,r&&v.onChange(o.value)}}};return o.addEventListener?o.addEventListener("keydown",h,!1):o.attachEvent("onkeydown",h),v}
